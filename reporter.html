<!-- one.upload https://u1.linnk.it/qc8sbw/usr/apps/textsync/docs/time-reporter-prototype-0.0.1 -->
<!DOCTYPE html>

<html lang="en">
<head>
<title>Time Reporter</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<link
	href="http://appjangle.com/assets/v02/bootstrap-2.1.0/css/bootstrap.min.css"
	rel="stylesheet">
<link
	href="http://appjangle.com/assets/v02/bootstrap-2.1.0/css/bootstrap-responsive.min.css"
	rel="stylesheet">

<link rel="stylesheet"
	href="http://appjangle.com/assets/v02/codemirror-2.32/codemirror.css">

<!-- <link rel="stylesheet"
	href="http://layout.jquery-dev.net/lib/css/layout-default.css"> -->

<style>
body {
	background-image: url('http://u1.linnk.it/assets/v01/img/beige3.png');
}

a.disabled-link,a.disabled-link:visited,a.disabled-link:active,a.disabled-link:hover
	{
	background-color: #d9d9d9 !important;
	color: #aaa !important;
}

.CodeMirror {
	font-size: 12pt;
}

.CodeMirror-scroll {
	height: auto;
	overflow-y: hidden;
	overflow-x: auto;
}

/* for footer */
.wrapper,.footer,.push {
	margin: 0;
}

html,body {
	height: 100%;
}

.wrapper {
	min-height: 100%;
	height: auto !important;
	height: 100%;
	margin: 0 auto -60px 0;
}

.footer,.push {
	height: 60px;
}
/* footer end */
</style>


</head>
<body>

	<div class="wrapper">
		<div class="container-fluid">
			<div id="ajnavbar">
				<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/ajMicroSync/docs/aj-navbar-html-0.0.2") -->
			</div>

			<div id="ajnotificationbar" style="display: none;">
				<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/ajMicroSync/docs/aj-notification-html-0.0.2") -->
			</div>

			<div id="ajprogressbar" style="display: none;">
				<div class="row-fluid">
					<div class="span12">
						<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/ajMicroSync/docs/aj-progress-html-0.0.2") -->
					</div>
				</div>
			</div>

			<div id="ajstatusbar" style="display: none;">
				<div class="row-fluid">
					<div class="span12">
						<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/ajMicroSync/docs/aj-status-html-0.0.2") -->
					</div>
				</div>
			</div>


			<div class="row-fluid">
				<div class="span12">
					<div class="nodeDetails">
						<form class="form-horizontal">
							<fieldset>

								<div class="addressGroup control-group" id="addressGroup">
									<label class="control-label" for="addressInput">Address</label>
									<div class="controls">
										<input class="addressInput input-xlarge focused"
											id="addressInput" style="width: 400px;" type="text"
											placeholder="Node address">
									</div>
								</div>

								<div class="secretGroupmcontrol-group" id="secretGroup">
									<label class="control-label" for="secretInput">Provide
										Access Secret</label>
									<div class="controls">
										<input class="secretInput input-xlarge" id="secretInput"
											style="width: 250px;" type="text"
											placeholder="(only when loading node from other user)">
									</div>
								</div>

								<div class="form-actions">
									<a type="input" class="loadButton btn btn-success">Load</a>
								</div>
							</fieldset>
						</form>
					</div>
				</div>
			</div>

			<div class="timeReporter" style="display: none;">
				<div class="row-fluid">
					<div class="span12">
						<div class="btn-group">
							<button class="startWorkButton btn btn-success">Start
								Work</button>
							<button class="stopWorkButton btn btn btn-danger">Stop
								Work</button>
						</div>
					</div>
				</div>

				<div class="row-fluid">
					<div class="span12">
						<h1>
							Passed Time: <span class="passedTime"></span>
						</h1>
					</div>
				</div>

				<div class="row-fluid">
					<div class="span12">
						<div id="editor">
							<div class="editorContent" style="display: none;">
								<textarea class="textArea"></textarea>
							</div>
						</div>
					</div>
				</div>
			</div>

		</div>
		<div class="push"></div>
	</div>

	<div class='footer'></div>

	<script type="text/javascript" language="javascript"
		src="http://appjangle.com/js/v01/onejs/onejs.nocache.js"></script>

	<script
		src="http://appjangle.com/assets/v02/codemirror-2.32/codemirror.js"></script>

	<script
		src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>

	<!-- <script
		src="http://ajax.googleapis.com/ajax/libs/jqueryui/1.8.23/jquery-ui.min.js"></script> -->


	<!-- <script src="http://methvin.com/splitter/splitter.js">
	</script> -->
	<!-- <script
		src="http://layout.jquery-dev.net/download/jquery.layout.min-1.2.0.js"></script> -->

	<script
		src="http://appjangle.com/assets/v02/bootstrap-2.1.0/js/bootstrap.min.js"></script>

	<script
		src="http://appjangle.com/assets/v02/jquery-hashchange-1.3/jquery.ba-hashchange.min.js"></script>

	<script
		src="http://appjangle.com/assets/v02/markdown-converter-120531/Markdown.Converter.js"> 	
	</script>

	<script>
// 
<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/ajMicroSync/docs/aj-core-0.0.2") -->
// 	
</script>

	<script>
// 
<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/textsync/docs/js-toolbox-0.0.1") -->
// 
</script>

	<script>
// 
<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/ajMicroSync/docs/aj-common-0.0.1") -->
// 
</script>

	<script>
// 
<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/ajMicroSync/docs/aj-navbar-js-0.0.2") -->
// 
</script>

	<script>
// 
<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/ajMicroSync/docs/aj-auth-0.0.1") -->
// 
</script>

	<script>
// 
<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/textsync/docs/aj-share-js-0.0.2") -->
// 
</script>

	<script>
// 
<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/ajMicroSync/docs/bootstrap-utils-js-0.0.1") -->
// 
</script>

	<script>
// 
<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/ajMicroSync/docs/aj-share-ui-js-0.0.1") -->
// 
</script>

	<script>
// 
<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/ajMicroSync/docs/aj-status-js-0.0.2") -->
// 
</script>

	<script>
// 
<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/ajMicroSync/docs/aj-notification-js-0.0.2") -->
// 
</script>

	<script>
// 
<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/ajMicroSync/docs/aj-progress-js-0.0.2") -->
// 
</script>

	<script>
// 
<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/ajMicroSync/docs/aj-edit-js-0.0.5") -->
// 
</script>


	<script>
// 
<!-- one.embedText("https://u1.linnk.it/qc8sbw/usr/apps/ajMicroSync/docs/aj-view-0.0.4") -->

// 
</script>



	<script>

	
	(function($, AJ) {
		
		$.initTimeReporter = function(client, elem) {
			
			tr = {};
			tr.edit = null;
			tr.commitTimer = null;
			
			tr.edit = $.initAjEdit($(".editorContent", elem), client);
			
			tr.edit.setEditorFactory(function() {
				$('.timeReporter', elem).show(); // to assure correct rendering
				$(".editorContent", elem).show(); // to assure codemirror is
				// rendered
				// correctly.

				var editorElem = $(".textArea", elem).get(0);
				if (!editorElem) {
					throw "Editor element is not defined: " + elem
							+ ".textArea";
				}

				var editor = CodeMirror.fromTextArea(editorElem, {
					// mode: 'markdown',
					lineNumbers : true,
					matchBrackets : true,
					theme : "default",
					indentWithTabs : true,
					lineWrapping : true,
					onChange : function(editor, changeParams) {
						
					}
				});

				return editor;
			});
			
			tr.edit.setTextChangeListener(function() {
				

			});
			
			$('.loadButton', elem).click(function(evt) {
				evt.preventDefault();
				
				var address= $('.addressInput', elem).val();
				var secret = $('.secretInput', elem).val();
				
				if (!secret) {
					secret = AJ.userNodeSecret;
				}
				
				tr.load(client.reference(address), secret, function() {
					$('.nodeDetails', elem).hide();
					$('.timeReporter', elem).show();
					tr.startAutoCommitAndUpdate();
				});
				
				
			});
			
			var startDate = null;
			
			var showTimeTimer = setInterval(function() {
				if (startDate) {
					var minutes = (new Date().getTime() - startDate.getTime() ) / (1000 * 60)+" ";
					
					$('.passedTime').html(minutes.substring(0, 5));
				}
			}, 1000);
			
			
			
			$('.startWorkButton', elem).click(function() {
				startDate = new Date();
			});
			
			$('.stopWorkButton', elem).click(function() {
				
				$('.passedTime', elem).html("");
				var codemirror = tr.edit.getEditor();
				
				var stopDate = new Date();
				
				var minutes = (stopDate.getTime() - startDate.getTime() ) / (1000 * 60)+" ";
				
				codemirror.setValue(codemirror.getValue()+
						"\nWorked "+minutes.substring(0, 5)+" --> [] / "+
						"from: "+startDate.getHours()+":"+startDate.getMinutes()+
						" to "+stopDate.getHours()+":" +stopDate.getMinutes()+" \n\n");
				
				
				startDate = null;
				
			});
			
			tr.readHash = function(hash, callback) {
				if (!hash || hash === null || hash === "" || hash === "#") {
					callback(false);
					return;
				}

				var link = AJ.utils.parseAppLink(hash);

				if (!link.address) {
					callback(false);
					return;
				}

				if (link.secret === null) {
					link.secret = AJ.userNodeSecret;
				}

				if (!AJ.userNodeUri) {
					
				}

				tr.load(client.reference(link.address), link.secret, function() {
					$('.nodeDetails', elem).hide();
					$('.timeReporter', elem).show();
					tr.startAutoCommitAndUpdate();
					
					callback(true);
				});
			};
			
			tr.load = function(node, secret, callback) {

				tr.edit.load(node.url(), secret, function() {
					
					callback();

				});
			};
			
			tr.startAutoCommitAndUpdate = function() {
				if (tr.commitTimer) {
					return;
				}
				
				tr.commitTimer = setInterval(function() {
					tr.edit.commitOrReload(function() {
						
					});
					}, 4000);
				
				tr.edit.commitOrReload(function() {
					
				});
				
			};
			
			tr.stopAutoCommitAndUpdate = function() {
				if (tr.commitTimer) {
					tr.commitTimer = null;
					clearInterval(tr.commitTimer);
				}
			};
			
			return {
				readHash: tr.readHash,
				load: tr.load,
				startAutoCommitAndUpdate: tr.startAutoCommitAndUpdate,
				stopAutomCommitAndUpdate: tr.stopAutoCommitAndUpdate
			};
			
		};
		
	}) (jQuery, AJ);
	
	function AJ_loginCompleted(aj, userLoggedIn) {

		var client = aj.createClient();
		
		var elem = $(document);
		
		var timereporter = $.initTimeReporter(client, elem);
		
		timereporter.readHash(window.location.hash, function() {
			
		});
		
		$(window).focus(function() {
			timereporter.startAutoCommitAndUpdate();
			
		});
		
		$(window).blur(function() {
			timereporter.stopAutoCommitAndUpdate();
			
		});
		
	}

	
	
	
	function AJ_engineLoaded(aj) {

		AJ.statusBar = $.ajInitStatusBar($("#ajstatusbar"), aj);
		AJ.notificationBar = $.ajInitNotificationBar($("#ajnotificationbar"), aj);
		AJ.navbar = $.ajInitNavbar($("#ajnavbar"), aj);
		AJ.progressBar=$.ajInitProgressBar($("#ajprogressbar"));
		
		
	}

	window.onload = function() {

	}
</script>

	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push([ '_setAccount', 'UA-34013716-1' ]);
		_gaq.push([ '_setDomainName', 'nodejump.com'  ]);
		_gaq.push([ '_setAllowLinker', true ]);
		_gaq.push([ '_trackPageview' ]);

		
		(function() {
			var ga = document.createElement('script');
			ga.type = 'text/javascript';
			ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl'
					: 'http://www')
					+ '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0];
			s.parentNode.insertBefore(ga, s);
		})();
	</script>
</body>

</html>

<!-- one.end -->
